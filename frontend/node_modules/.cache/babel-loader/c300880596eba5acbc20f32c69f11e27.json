{"ast":null,"code":"import _slicedToArray from\"/Users/pedromonteiroborges/Desktop/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import ProfilePic from\"../components/ProfilePic\";import{Link}from\"react-router-dom\";import\"./editProfile.css\";import\"../App.css\";import firebase from\"firebase\";import{Redirect}from'react-router-dom';import Auth from\"firebase\";import TextBox from\"../components/TextBox\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function EditProfile(props){//let user = props.user\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),deleteAccount=_useState2[0],setDeleteAccount=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),newEmail=_useState4[0],setNewEmail=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),newName=_useState6[0],setNewName=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),newPassword=_useState8[0],setNewPassword=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),newPicURL=_useState10[0],setNewPicURL=_useState10[1];// const [emailError, setEmailError] = useState('')\n// const [logMessage, setLogMessage] = useState('')\nvar _useState11=useState(''),_useState12=_slicedToArray(_useState11,2),logMessage=_useState12[0],setLogMessage=_useState12[1];//https://www.youtube.com/watch?v=31MVIwvstzs&ab_channel=SoftAuthor -> change profile\nvar user=Auth.auth().currentUser;var db=firebase.firestore();var clearInputs=function clearInputs(){setNewName('');setNewEmail('');setNewPassword('');};var clearErrors=function clearErrors(){setLogMessage('');setLogMessage('');};var removeUserAndData=function removeUserAndData(){// //remove user data\ndb.collection(\"users\").document(user.uid).delete();// remove account\nuser.delete().then(function(){console.log(\"user successfully deleted\");}).catch(function(error){console.log(\"user was not successfully deleted\"+error);});setDeleteAccount(true);};var updateProfile=function updateProfile(){updateEmail();updatePassword();user.updateProfile({displayName:newName!==\"\"?newName:user.displayName,photoURL:newPicURL}).then(function(){console.log(\"user successfully updated to \"+newName);setLogMessage(logMessage+\"user info successfully updated\");// newPassword ? user.updatePassword(newPassword) : null;\n// newEmail ? user.updateEmail(newEmail) : null;\n}).catch(function(error){console.log(\"user not successfully updated\"+error);});clearInputs();};// useEffect(() => {\n//     if (newEmail !== \"\")\n//         user.updateEmail(newEmail)\n//             .then(r =>  {\n//                 console.log(r + \":user successfully updated Email\")\n//                 setLogMessage(logMessage + \"<br>\" + \"user successfully updated Email \" + newEmail)\n//             })\n//             .catch(err => {\n//                 switch(err.code) {\n//                     case \"auth/email-already-in-use\":\n//                     case \"auth/invalid-email\":\n//                         setLogMessage(err.message);\n//                         break;\n//                 }\n//             });\n//     }, [newEmail]);\nfunction updatePassword(){if(newPassword!==\"\")user.updatePassword(newPassword).then(function(r){return console.log(r+\":user successfully updated password\");}).catch(function(err){switch(err.code){case\"auth/weak-password\":setLogMessage(err.message);break;}});}function updateEmail(){if(newEmail!==\"\")user.updateEmail(newEmail).then(function(r){console.log(r+\":user successfully updated Email\");setLogMessage(logMessage+\"<br>\"+\"user successfully updated Email \"+newEmail);}).catch(function(err){switch(err.code){case\"auth/email-already-in-use\":case\"auth/invalid-email\":console.log(err.message);setLogMessage(err.message);break;}});}function getNewPicUrl(e){setNewPicURL(e.target.files[0]);updateProfile();}return/*#__PURE__*/_jsx(\"div\",{className:\"main\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"profile\",children:[/*#__PURE__*/_jsx(ProfilePic,{user:user,className:\"profilePicLarge\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"b\",{children:\"Edit Profile Image:  \"}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",id:\"myFile\",onChange:function onChange(e){return getNewPicUrl(e);}}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Name: \",user.displayName]}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"h2\",{children:\"Edit User Information\"}),/*#__PURE__*/_jsx(TextBox,{type:\"text\",label:\"Change name \",focus:false,value:newName,change:setNewName}),/*#__PURE__*/_jsx(TextBox,{type:\"text\",label:\"Change email \",focus:false,value:newEmail,change:setNewEmail}),/*#__PURE__*/_jsx(TextBox,{type:\"text\",label:\"Change password \",focus:false,value:newPassword,change:setNewPassword}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return updateProfile();},children:\"Submit changes\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"p\",{children:logMessage}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return removeUserAndData();},children:\"Delete  Account\"}),deleteAccount?/*#__PURE__*/_jsx(Redirect,{to:\"/Login\"}):null]})});}export default EditProfile;","map":{"version":3,"sources":["/Users/pedromonteiroborges/Desktop/CS32/Projects/term-project-awhite35-mcamach6-mhe26-pmontei1/frontend/src/pages/EditProfile.js"],"names":["React","useState","useEffect","ProfilePic","Link","firebase","Redirect","Auth","TextBox","EditProfile","props","deleteAccount","setDeleteAccount","newEmail","setNewEmail","newName","setNewName","newPassword","setNewPassword","newPicURL","setNewPicURL","logMessage","setLogMessage","user","auth","currentUser","db","firestore","clearInputs","clearErrors","removeUserAndData","collection","document","uid","delete","then","console","log","catch","error","updateProfile","updateEmail","updatePassword","displayName","photoURL","r","err","code","message","getNewPicUrl","e","target","files"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport ProfilePic from \"../components/ProfilePic\";\nimport {Link} from \"react-router-dom\";\nimport \"./editProfile.css\"\nimport \"../App.css\"\nimport firebase from \"firebase\";\nimport { Redirect } from 'react-router-dom'\nimport Auth from \"firebase\";\nimport TextBox from \"../components/TextBox\";\n\nfunction EditProfile(props) {\n    //let user = props.user\n    const [deleteAccount, setDeleteAccount] = useState(false);\n    const [newEmail, setNewEmail] = useState(\"\")\n    const [newName, setNewName] = useState(\"\")\n    const [newPassword, setNewPassword] = useState(\"\")\n    const [newPicURL, setNewPicURL] = useState(null)\n    // const [emailError, setEmailError] = useState('')\n    // const [logMessage, setLogMessage] = useState('')\n    const [logMessage, setLogMessage] = useState('')\n//https://www.youtube.com/watch?v=31MVIwvstzs&ab_channel=SoftAuthor -> change profile\n\n    let user = Auth.auth().currentUser\n    const db = firebase.firestore();\n\n    const clearInputs = () => {\n        setNewName('');\n        setNewEmail('');\n        setNewPassword('');\n    }\n\n\n    const clearErrors = () => {\n        setLogMessage('');\n        setLogMessage('');\n    }\n\n    const removeUserAndData = () => {\n        // //remove user data\n        db.collection(\"users\").document(user.uid).delete();\n        // remove account\n        user.delete().then(function() {\n            console.log(\"user successfully deleted\")\n        }).catch(function(error) {\n            console.log(\"user was not successfully deleted\"+      error)\n        });\n        setDeleteAccount(true);\n    }\n\n    const updateProfile = () => {\n        updateEmail();\n        updatePassword();\n        user.updateProfile({\n            displayName: newName !== \"\" ? newName: user.displayName,\n            photoURL: newPicURL,\n        }).then(function() {\n            console.log(\"user successfully updated to \" + newName)\n            setLogMessage(logMessage  + \"user info successfully updated\")\n            // newPassword ? user.updatePassword(newPassword) : null;\n            // newEmail ? user.updateEmail(newEmail) : null;\n        }).catch(function(error) {\n            console.log(\"user not successfully updated\"+  error)\n        });\n        clearInputs();\n    }\n    // useEffect(() => {\n    //     if (newEmail !== \"\")\n    //         user.updateEmail(newEmail)\n    //             .then(r =>  {\n    //                 console.log(r + \":user successfully updated Email\")\n    //                 setLogMessage(logMessage + \"<br>\" + \"user successfully updated Email \" + newEmail)\n    //             })\n    //             .catch(err => {\n    //                 switch(err.code) {\n    //                     case \"auth/email-already-in-use\":\n    //                     case \"auth/invalid-email\":\n    //                         setLogMessage(err.message);\n    //                         break;\n    //                 }\n    //             });\n    //     }, [newEmail]);\n\n    function updatePassword() {\n        if (newPassword !== \"\")\n            user.updatePassword(newPassword)\n                .then(r =>  console.log(r + \":user successfully updated password\"))\n                .catch(err => {\n                    switch(err.code) {\n                        case \"auth/weak-password\":\n                            setLogMessage(err.message);\n                            break;\n                    }\n                });\n    }\n    function updateEmail() {\n        if (newEmail !== \"\")\n            user.updateEmail(newEmail)\n                .then(r =>  {\n                    console.log(r + \":user successfully updated Email\")\n                    setLogMessage(logMessage + \"<br>\" + \"user successfully updated Email \" + newEmail)\n                })\n                .catch(err => {\n                    switch(err.code) {\n                        case \"auth/email-already-in-use\":\n                        case \"auth/invalid-email\":\n                            console.log(err.message)\n                            setLogMessage(err.message);\n                            break;\n                    }\n                });\n    }\n\n\n    function getNewPicUrl(e) {\n        setNewPicURL(e.target.files[0])\n        updateProfile();\n    }\n\n    return (\n        <div className=\"main\">\n            <div className=\"profile\" >\n                <ProfilePic user={user} className={\"profilePicLarge\"}/>\n                <br/>\n                <b>Edit Profile Image:  </b>\n                <input type=\"file\" id=\"myFile\" onChange={(e)=>getNewPicUrl(e)}/>\n                <br/><br/>\n\n                <h1>Name: {user.displayName}</h1>\n                <hr/>\n\n                <h2>Edit User Information</h2>\n                <TextBox type={\"text\"} label={\"Change name \"} focus={false} value={newName} change={setNewName}/>\n                <TextBox type={\"text\"} label={\"Change email \"} focus={false} value={newEmail} change={setNewEmail}/>\n                <TextBox type={\"text\"} label={\"Change password \"} focus={false} value={newPassword} change={setNewPassword}/>\n                <button onClick={()=>updateProfile()}>Submit changes</button>\n                <br/><br/>\n                <p>{logMessage}</p>\n                <button onClick={() => removeUserAndData()}>Delete  Account</button>\n                {deleteAccount ? <Redirect to=\"/Login\" /> : null}\n            </div>\n        </div>\n    )\n}\n\nexport default EditProfile"]},"metadata":{},"sourceType":"module"}