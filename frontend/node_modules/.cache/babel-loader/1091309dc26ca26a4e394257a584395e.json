{"ast":null,"code":"var _jsxFileName = \"/Users/pedromonteiroborges/Desktop/CS32/Projects/term-project-awhite35-mcamach6-mhe26-pmontei1/frontend/src/pages/EditProfile.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport ProfilePic from \"../components/ProfilePic\";\nimport { Link } from \"react-router-dom\";\nimport \"./editProfile.css\";\nimport \"../App.css\";\nimport firebase from \"firebase\";\nimport { Redirect } from 'react-router-dom';\nimport Auth from \"firebase\";\nimport TextBox from \"../components/TextBox\";\nimport PopUp from \"../components/PopUp\";\nimport PopUpText from \"../components/PopUpText\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction EditProfile() {\n  _s();\n\n  //let user = props.user\n  const [newEmail, setNewEmail] = useState(\"\");\n  const [newName, setNewName] = useState(\"\");\n  const [newPassword, setNewPassword] = useState(\"\");\n  const [newPicURL, setNewPicURL] = useState(null);\n  const [hasPic, setHasPic] = useState(false);\n  const [errorMessage, setErrorMessage] = useState('');\n  const [logMessage, setLogMessage] = useState('');\n  const [deleteAcc, setDeleteAcc] = useState(false);\n  const [popUpSeen, setPopUpSeen] = useState(false); //https://www.youtube.com/watch?v=31MVIwvstzs&ab_channel=SoftAuthor -> change profile\n\n  let user = Auth.auth().currentUser;\n  const db = firebase.firestore();\n\n  const clearInputs = () => {\n    setNewName('');\n    setNewEmail('');\n    setNewPassword('');\n  };\n\n  const clearErrors = () => {\n    setLogMessage('');\n    setErrorMessage('');\n  };\n\n  const profilePicRef = firebase.storage().ref('users/' + user.uid + '/profile.jpg'); //TODO:\n  //sources: https://stackoverflow.com/questions/45386065/firebase-user-photourl-to-string\n  // https://www.youtube.com/watch?v=31MVIwvstzs&ab_channel=SoftAuthor\n\n  function getNewPicUrl(e) {\n    setNewPicURL(e.target.files[0]);\n    setHasPic(true);\n    profilePicRef.put(e.target.files[0]).then(function (snapshot) {\n      console.log(snapshot);\n      snapshot.ref.getDownloadURL().then(function (url) {\n        // Now I can use url\n        user.updateProfile({\n          photoURL: url // <- URL from uploaded photo.\n\n        }).then(r => {\n          setLogMessage(\"User image updated. Refresh page to see changes\");\n        });\n      });\n    });\n    console.log(\"user image updated\"); //updateProfile();\n  } // Delete the user file in storage\n\n\n  function deleteProfPic() {\n    profilePicRef.delete().then(() => {\n      // File deleted successfully\n      console.log(\"profile pic deleted successfully\");\n    }).catch(error => {\n      // Uh-oh, an error occurred!\n      console.log(error);\n    });\n  } // Delete User's Account\n\n\n  const removeUserAndData = () => {\n    if (hasPic) {\n      deleteProfPic();\n    }\n\n    user.delete().then(function () {\n      deleteAccountAlert();\n    }).catch(function (error) {\n      if (error.code === 'auth/requires-recent-login') {\n        window.alert('Please sign-in and try again.');\n        firebase.auth().signOut();\n      }\n    });\n  };\n\n  const deleteAccountAlert = () => {\n    let input = prompt(\"Type DELETE to delete your account.\");\n\n    if (input === \"DELETE\") {\n      alert(\"Account Successfully Deleted!\");\n    }\n  };\n\n  const updateProfile = () => {\n    clearInputs();\n    clearErrors();\n    user.updateProfile({\n      displayName: newName !== \"\" ? newName : user.displayName\n    }).then(function () {\n      console.log(\"user successfully updated\");\n      console.log(\"New User:\" + user);\n      setLogMessage(\"user successfully updated\"); // newPassword ? user.updatePassword(newPassword) : null;\n      // newEmail ? user.updateEmail(newEmail) : null;\n    }).catch(function (error) {\n      console.log(error);\n      console.log(user);\n      setErrorMessage(\"Error occurred when updating name.\");\n    });\n  };\n\n  function updatePassword() {\n    clearInputs();\n    clearErrors();\n    if (newPassword !== \"\") user.updatePassword(newPassword).then(function () {\n      console.log(\"user successfully updated password\");\n      setLogMessage(\"Successfully updated password\");\n    }).catch(err => {\n      switch (err.code) {\n        case \"auth/weak-password\":\n          setErrorMessage(err.message);\n          break;\n      }\n    });\n  }\n\n  function updateEmail() {\n    clearInputs();\n    clearErrors();\n    if (newEmail !== \"\") user.updateEmail(newEmail).then(r => {\n      console.log(r + \":user successfully updated Email\");\n      setLogMessage(logMessage + \"user successfully updated email to \" + newEmail);\n    }).catch(err => {\n      switch (err.code) {\n        case \"auth/email-already-in-use\":\n        case \"auth/invalid-email\":\n          console.log(err.message);\n          setErrorMessage(err.message);\n          break;\n      }\n    });\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"main\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"profile\",\n      children: [/*#__PURE__*/_jsxDEV(ProfilePic, {\n        user: user,\n        className: \"profilePicLarge\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n        children: \"Edit Profile Image: \"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        id: \"myFile\",\n        accept: \"image/jpeg\",\n        onChange: e => getNewPicUrl(e)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 22\n      }, this), /*#__PURE__*/_jsxDEV(\"h1\", {\n        children: [\"Name: \", user.displayName]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"hr\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"profileChangeContainer\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          id: \"EditUserInfoTitle\",\n          children: \"Edit User Information\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profileChange\",\n          children: [/*#__PURE__*/_jsxDEV(TextBox, {\n            className: \"changeBox\",\n            type: \"text\",\n            label: \"Change name \",\n            focus: false,\n            value: newName,\n            change: setNewName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 25\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => updateProfile(),\n            className: \"profileChangeButton\",\n            children: \"Submit change\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profileChange\",\n          children: [/*#__PURE__*/_jsxDEV(TextBox, {\n            className: \"changeBox\",\n            type: \"text\",\n            label: \"Change email \",\n            focus: false,\n            value: newEmail,\n            change: setNewEmail\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 25\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => updateEmail(),\n            className: \"profileChangeButton\",\n            children: \"Submit change\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"profileChange\",\n          children: [/*#__PURE__*/_jsxDEV(TextBox, {\n            className: \"changeBox\",\n            type: \"text\",\n            label: \"Change password \",\n            focus: false,\n            value: newPassword,\n            change: setNewPassword\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 191,\n            columnNumber: 25\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => updatePassword(),\n            className: \"profileChangeButton\",\n            children: \"Submit change\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 195,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"errorMsg\",\n          children: errorMessage\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 21\n        }, this), logMessage]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 22\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"deleteButton\",\n        onClick: () => removeUserAndData(),\n        children: \"Delete Account\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 165,\n    columnNumber: 9\n  }, this);\n}\n\n_s(EditProfile, \"2cEXN/MGi+XWBCEtIb0ngn55jDc=\");\n\n_c = EditProfile;\nexport default EditProfile;\n\nvar _c;\n\n$RefreshReg$(_c, \"EditProfile\");","map":{"version":3,"sources":["/Users/pedromonteiroborges/Desktop/CS32/Projects/term-project-awhite35-mcamach6-mhe26-pmontei1/frontend/src/pages/EditProfile.js"],"names":["React","useState","useEffect","ProfilePic","Link","firebase","Redirect","Auth","TextBox","PopUp","PopUpText","EditProfile","newEmail","setNewEmail","newName","setNewName","newPassword","setNewPassword","newPicURL","setNewPicURL","hasPic","setHasPic","errorMessage","setErrorMessage","logMessage","setLogMessage","deleteAcc","setDeleteAcc","popUpSeen","setPopUpSeen","user","auth","currentUser","db","firestore","clearInputs","clearErrors","profilePicRef","storage","ref","uid","getNewPicUrl","e","target","files","put","then","snapshot","console","log","getDownloadURL","url","updateProfile","photoURL","r","deleteProfPic","delete","catch","error","removeUserAndData","deleteAccountAlert","code","window","alert","signOut","input","prompt","displayName","updatePassword","err","message","updateEmail"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from \"react\";\nimport ProfilePic from \"../components/ProfilePic\";\nimport {Link} from \"react-router-dom\";\nimport \"./editProfile.css\"\nimport \"../App.css\"\nimport firebase from \"firebase\";\nimport {Redirect} from 'react-router-dom'\nimport Auth from \"firebase\";\nimport TextBox from \"../components/TextBox\";\nimport PopUp from \"../components/PopUp\";\nimport PopUpText from \"../components/PopUpText\";\n\n\nfunction EditProfile() {\n    //let user = props.user\n    const [newEmail, setNewEmail] = useState(\"\")\n    const [newName, setNewName] = useState(\"\")\n    const [newPassword, setNewPassword] = useState(\"\")\n    const [newPicURL, setNewPicURL] = useState(null)\n    const [hasPic, setHasPic] = useState(false)\n    const [errorMessage, setErrorMessage] = useState('')\n    const [logMessage, setLogMessage] = useState('')\n\n    const [deleteAcc, setDeleteAcc] = useState(false);\n    const [popUpSeen, setPopUpSeen] = useState(false);\n//https://www.youtube.com/watch?v=31MVIwvstzs&ab_channel=SoftAuthor -> change profile\n\n    let user = Auth.auth().currentUser\n    const db = firebase.firestore();\n\n    const clearInputs = () => {\n        setNewName('');\n        setNewEmail('');\n        setNewPassword('');\n    }\n\n\n    const clearErrors = () => {\n        setLogMessage('');\n        setErrorMessage('');\n    }\n\n\n    const profilePicRef = firebase.storage().ref('users/' + user.uid + '/profile.jpg')\n//TODO:\n    //sources: https://stackoverflow.com/questions/45386065/firebase-user-photourl-to-string\n    // https://www.youtube.com/watch?v=31MVIwvstzs&ab_channel=SoftAuthor\n    function getNewPicUrl(e) {\n        setNewPicURL(e.target.files[0]);\n        setHasPic(true);\n        profilePicRef.put(e.target.files[0])\n            .then(function (snapshot) {\n                console.log(snapshot)\n                snapshot.ref.getDownloadURL()\n                    .then(function (url) {  // Now I can use url\n                        user.updateProfile({\n                            photoURL: url       // <- URL from uploaded photo.\n                        }).then(r => {\n                            setLogMessage(\"User image updated. Refresh page to see changes\")\n                        });\n                    })\n            })\n        console.log(\"user image updated\")\n        //updateProfile();\n    }\n\n// Delete the user file in storage\n    function deleteProfPic() {\n        profilePicRef.delete().then(() => {\n            // File deleted successfully\n            console.log(\"profile pic deleted successfully\")\n        }).catch((error) => {\n            // Uh-oh, an error occurred!\n            console.log(error)\n        });\n\n    }\n\n// Delete User's Account\n    const removeUserAndData = () => {\n        if (hasPic) {\n            deleteProfPic();\n        }\n        user.delete()\n            .then(function() {\n                deleteAccountAlert()\n            })\n            .catch(function (error) {\n            if (error.code === 'auth/requires-recent-login') {\n                window.alert('Please sign-in and try again.');\n                firebase.auth().signOut();\n            }\n        });\n    }\n\n    const deleteAccountAlert = () => {\n        let input = prompt(\"Type DELETE to delete your account.\");\n        if (input === \"DELETE\") {\n            alert(\"Account Successfully Deleted!\")\n        }\n    }\n\n    const updateProfile = () => {\n        clearInputs();\n        clearErrors();\n        user.updateProfile({\n            displayName: newName !== \"\" ? newName : user.displayName,\n        }).then(function () {\n            console.log(\"user successfully updated\");\n            console.log(\"New User:\" + user)\n            setLogMessage(\"user successfully updated\");\n            // newPassword ? user.updatePassword(newPassword) : null;\n            // newEmail ? user.updateEmail(newEmail) : null;\n        }).catch(function (error) {\n            console.log(error)\n            console.log(user)\n            setErrorMessage(\"Error occurred when updating name.\")\n        });\n    }\n\n\n    function updatePassword() {\n        clearInputs();\n        clearErrors();\n        if (newPassword !== \"\")\n            user.updatePassword(newPassword)\n                .then(function () {\n                    console.log( \"user successfully updated password\")\n                    setLogMessage(\"Successfully updated password\")\n                    }\n                )\n                .catch(err => {\n                    switch (err.code) {\n                        case \"auth/weak-password\":\n                            setErrorMessage(err.message);\n                            break;\n                    }\n                });\n\n    }\n\n    function updateEmail() {\n        clearInputs();\n        clearErrors();\n        if (newEmail !== \"\")\n            user.updateEmail(newEmail)\n                .then(r => {\n                    console.log(r + \":user successfully updated Email\")\n                    setLogMessage(logMessage + \"user successfully updated email to \" + newEmail)\n                })\n\n                .catch(err => {\n                    switch (err.code) {\n                        case \"auth/email-already-in-use\":\n                        case \"auth/invalid-email\":\n                            console.log(err.message)\n                            setErrorMessage(err.message);\n                            break;\n                    }\n                });\n    }\n\n\n    return (\n        <div className=\"main\">\n            <div className=\"profile\">\n                <ProfilePic user={user} className={\"profilePicLarge\"}/>\n                <br/>\n                <b>Edit Profile Image: </b>\n                <input type=\"file\" id=\"myFile\" accept=\"image/jpeg\" onChange={(e) => getNewPicUrl(e)}/>\n                <br/><br/>\n\n                <h1>Name: {user.displayName}</h1>\n                <hr/>\n\n\n                <div className=\"profileChangeContainer\">\n                    <h2 id=\"EditUserInfoTitle\">Edit User Information</h2>\n                    <br/>\n                    <div className=\"profileChange\">\n                        <TextBox className=\"changeBox\" type={\"text\"} label={\"Change name \"} focus={false}\n                                 value={newName} change={setNewName}/>{\" \"}\n                        <button onClick={() => updateProfile()} className=\"profileChangeButton\">Submit change</button>\n                    </div>\n                    <div className=\"profileChange\">\n                        <TextBox className=\"changeBox\" type={\"text\"} label={\"Change email \"} focus={false}\n                                 value={newEmail} change={setNewEmail}/>{\" \"}\n                        <button onClick={() => updateEmail()} className=\"profileChangeButton\">Submit change</button>\n                    </div>\n                    <div className=\"profileChange\">\n                        <TextBox className=\"changeBox\" type={\"text\"} label={\"Change password \"} focus={false}\n                                 value={newPassword} change={setNewPassword}/>{\" \"}\n                        <button onClick={() => updatePassword()} className=\"profileChangeButton\">Submit change</button>\n                    </div>\n                    <br/>\n                    <p className=\"errorMsg\">{errorMessage}</p>\n                    {logMessage}\n                </div>\n\n\n                <br/><br/>\n\n                <button className=\"deleteButton\" onClick={() => removeUserAndData()}>Delete Account</button>\n\n            </div>\n        </div>\n    )\n}\n\nexport default EditProfile\n"]},"metadata":{},"sourceType":"module"}